import { PORT } from './config';
import brApp from '../src/index';

const path = require('path');
const webpack = require('webpack');
const express = require('express');
const WebpackDevServer = require('webpack-dev-server');
// const historyApiFallback = require('connect-history-api-fallback');
const chalk = require('chalk');

const webpackConfig = require('./webpack.config');

let app = null;

app = new WebpackDevServer(webpack(webpackConfig), {
  contentBase: '/build/',
  // proxy: { '/graphql': GRAPHQL_PATH },
  stats: "minimal",
  hot: true,
  historyApiFallback: true
});

// Serve static resources
app.use('/', express.static(path.join(__dirname, '../build')));
app.use(brApp.getRootPath(), express.static(path.join(__dirname, '../src/public')));
console.log('\n\n\n');
app.listen(PORT, () => console.log(chalk.green(`BlueRain App is listening on port ${PORT}`)));
