/**
 * Created by anser on 19/5/17.
 */

import React from 'react';
import ReactDOM from 'react-dom';
import TestUtils from 'react-addons-test-utils';
import { shallow } from 'enzyme';

import { SonosSensorInfoData, disconnectedSonosSensorInfoData } from '../../../../__mocks__/AssetSensorInfo.mock';
import SonosSensorInfo from '../../../../src/components/Asset/SonosSensorInfo/SonosSensorInfo.container';

describe('SonosSensorInfo Component Test Specifications', () => {


  it('should check proptype of data', () => {
    const sensorInfoData = {
      node :{
        state: {
          connected: SonosSensorInfoData.connected,
          song: SonosSensorInfoData.song,
          album: SonosSensorInfoData.album,
          artist: SonosSensorInfoData.artist,
          image: SonosSensorInfoData.image
        }

      }
    };
    const cardWrapper = <SonosSensorInfo data={sensorInfoData} />;
    expect( typeof cardWrapper.props.data ).toEqual( 'object' );
  });


  it('should render successfully when params are passed', () => {
    const div = document.createElement('div');
    const sensorInfoData = {
      node :{
        state: {
          connected: SonosSensorInfoData.connected,
          song: SonosSensorInfoData.song,
          album: SonosSensorInfoData.album,
          artist: SonosSensorInfoData.artist,
          image: SonosSensorInfoData.image
        }

      }
    };
    ReactDOM.render(<SonosSensorInfo data={sensorInfoData} />, div);

  });

  it('element with list-group-item should not exist when connected prop is not passed.', () => {
    const sensorInfoData = {
      node :{
        state: {
          song: SonosSensorInfoData.song,
          album: SonosSensorInfoData.album,
          artist: SonosSensorInfoData.artist,
          image: SonosSensorInfoData.image
        }

      }
    };
    const component = TestUtils.renderIntoDocument( <SonosSensorInfo data={sensorInfoData} /> );

    const connectedDiv = TestUtils.scryRenderedDOMComponentsWithClass(component, 'list-group-item');

    expect(connectedDiv.length).toEqual(0);

  });

  it('icon class should be text-success when connected = true', () => {
    const sensorInfoData = {
      node :{
        state: {
          connected: SonosSensorInfoData.connected,
          song: SonosSensorInfoData.song,
          album: SonosSensorInfoData.album,
          artist: SonosSensorInfoData.artist,
          image: SonosSensorInfoData.image
        }

      }
    };
    const component = TestUtils.renderIntoDocument( <SonosSensorInfo data={sensorInfoData} /> );

    const iconSpan = TestUtils.scryRenderedDOMComponentsWithClass(component, 'text-success');

    expect(iconSpan.length).toEqual(1);

  });

  it('icon class should be text-danger when connected = false', () => {

    const sensorInfoData = {
      node :{
        state: {
          connected: disconnectedSonosSensorInfoData.connected,
          song: SonosSensorInfoData.song,
          album: SonosSensorInfoData.album,
          artist: SonosSensorInfoData.artist,
          image: SonosSensorInfoData.image
        }

      }
    };
    const component = TestUtils.renderIntoDocument( <SonosSensorInfo data={sensorInfoData} /> );

    const iconSpan = TestUtils.scryRenderedDOMComponentsWithClass(component, 'text-danger');

    expect(iconSpan.length).toEqual(1);

  });
});

it('should return empty div when connected is not of type boolean', () => {
  const sensorInfoData = {
    node :{
      state: {
        connected: '',
        song: SonosSensorInfoData.song,
        album: SonosSensorInfoData.album,
        artist: SonosSensorInfoData.artist,
        image: SonosSensorInfoData.image
      }

    }
  };
  const component = TestUtils.renderIntoDocument( <SonosSensorInfo data={sensorInfoData} /> );

  const connectedDiv = TestUtils.scryRenderedDOMComponentsWithClass(component, 'list-group-item');

  expect(connectedDiv.length).toEqual(0);

});

it('CardBlock element count should be equal to 1', () => {
  const sensorInfoData = {
    node :{
      state: {
        connected: '',
        song: SonosSensorInfoData.song,
        album: SonosSensorInfoData.album,
        artist: SonosSensorInfoData.artist,
        image: SonosSensorInfoData.image
      }
    }
  };
  const cardWrapper = shallow(<SonosSensorInfo data={sensorInfoData} />);
  expect(cardWrapper.find('CardBlock').length).toEqual(1);
});

